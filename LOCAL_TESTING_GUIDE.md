# BettaFish æœ¬åœ°æµ‹è¯•æŒ‡å—

## ğŸ“‹ æµ‹è¯•å‰å‡†å¤‡

### 1. æ£€æŸ¥ä¾èµ–å®‰è£…

```powershell
# æ£€æŸ¥Workersä¾èµ–
cd bettafish-workers
if (Test-Path "node_modules") {
    Write-Host "âœ… Workers dependencies installed" -ForegroundColor Green
} else {
    Write-Host "âŒ Installing Workers dependencies..." -ForegroundColor Yellow
    npm install
}

# æ£€æŸ¥å‰ç«¯ä¾èµ–
cd ../bettafish-frontend
if (Test-Path "node_modules") {
    Write-Host "âœ… Frontend dependencies installed" -ForegroundColor Green
} else {
    Write-Host "âŒ Installing Frontend dependencies..." -ForegroundColor Yellow
    npm install
}
```

### 2. æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®

**å‰ç«¯** - ç¡®è®¤ `bettafish-frontend/.env.local` å­˜åœ¨:
```env
NEXT_PUBLIC_API_URL=http://localhost:8787
```

**Workers** - ç¡®è®¤ `bettafish-workers/.dev.vars` å­˜åœ¨:
```env
ENVIRONMENT=development
BACKEND_URL=http://localhost:5000
BACKEND_TOKEN=
```

### 3. æ£€æŸ¥Wrangler CLI

```powershell
wrangler --version
```

å¦‚æœæœªå®‰è£…:
```powershell
npm install -g wrangler
wrangler login
```

## ğŸš€ å¯åŠ¨æµ‹è¯•ç¯å¢ƒ

### æ–¹æ³•1: ä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰

```powershell
.\start-test.ps1
```

è¿™å°†è‡ªåŠ¨ï¼š
- æ£€æŸ¥ä¾èµ–
- å¯åŠ¨Workers APIï¼ˆæ–°çª—å£ï¼‰
- å¯åŠ¨å‰ç«¯ï¼ˆæ–°çª—å£ï¼‰

### æ–¹æ³•2: æ‰‹åŠ¨å¯åŠ¨

**æ‰“å¼€3ä¸ªç»ˆç«¯çª—å£**:

**ç»ˆç«¯1 - Workers API**:
```powershell
cd bettafish-workers
npm run dev
```

**ç»ˆç«¯2 - å‰ç«¯**:
```powershell
cd bettafish-frontend
npm run dev
```

**ç»ˆç«¯3 - Pythonåç«¯** (å¯é€‰ï¼Œå¦‚æœå·²é…ç½®):
```powershell
cd BettaFish-main
python app.py
```

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### Step 1: éªŒè¯Workers APIå¯åŠ¨

**æ£€æŸ¥ç»ˆç«¯1è¾“å‡º**ï¼Œåº”è¯¥çœ‹åˆ°:
```
â” Starting local server...
[wrangler:inf] Ready on http://localhost:8787
```

**æµ‹è¯•å¥åº·æ£€æŸ¥**:
```powershell
# æ–¹æ³•1: ä½¿ç”¨PowerShell
Invoke-WebRequest -Uri "http://localhost:8787/api/health" -UseBasicParsing

# æ–¹æ³•2: ä½¿ç”¨æµè§ˆå™¨
# è®¿é—®: http://localhost:8787/api/health
```

**é¢„æœŸå“åº”**:
```json
{
  "status": "ok",
  "timestamp": "2025-11-09T...",
  "environment": "development"
}
```

### Step 2: éªŒè¯å‰ç«¯å¯åŠ¨

**æ£€æŸ¥ç»ˆç«¯2è¾“å‡º**ï¼Œåº”è¯¥çœ‹åˆ°:
```
âœ“ Ready in X ms
â—‹ Local:        http://localhost:3000
```

**æ‰“å¼€æµè§ˆå™¨è®¿é—®**: http://localhost:3000

**åº”è¯¥çœ‹åˆ°**:
- BettaFishä¸»ç•Œé¢
- æœç´¢æ¡†
- é…ç½®æŒ‰é’®
- ç”ŸæˆæŠ¥å‘ŠæŒ‰é’®

### Step 3: æµ‹è¯•APIç«¯ç‚¹

**ä½¿ç”¨æµ‹è¯•è„šæœ¬**:
```powershell
cd bettafish-workers
.\test-api.ps1
```

**æˆ–æ‰‹åŠ¨æµ‹è¯•**:

```powershell
# 1. å¥åº·æ£€æŸ¥
curl http://localhost:8787/api/health

# 2. ç³»ç»ŸçŠ¶æ€ï¼ˆå¯èƒ½æ˜¾ç¤ºåç«¯ä¸å¯ç”¨ï¼Œè¿™æ˜¯æ­£å¸¸çš„ï¼‰
curl http://localhost:8787/api/status

# 3. è·å–é…ç½®ï¼ˆéœ€è¦åç«¯è¿è¡Œï¼‰
curl http://localhost:8787/api/config
```

### Step 4: æµ‹è¯•å‰ç«¯åŠŸèƒ½

#### 4.1 æµ‹è¯•æœç´¢åŠŸèƒ½
1. åœ¨æœç´¢æ¡†è¾“å…¥æµ‹è¯•æŸ¥è¯¢
2. ç‚¹å‡»"æœç´¢"æŒ‰é’®
3. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰çš„Networkæ ‡ç­¾
4. æŸ¥çœ‹APIè¯·æ±‚å’Œå“åº”

#### 4.2 æµ‹è¯•é…ç½®ç®¡ç†
1. ç‚¹å‡»"é…ç½®"æŒ‰é’®
2. åº”è¯¥æ‰“å¼€é…ç½®å¯¹è¯æ¡†
3. åˆ‡æ¢ä¸åŒçš„Tabï¼ˆæ•°æ®åº“ã€Insightã€Mediaç­‰ï¼‰
4. å°è¯•ä¿®æ”¹é…ç½®ï¼ˆä¸ä¼šçœŸæ­£ä¿å­˜ï¼Œé™¤éåç«¯è¿è¡Œï¼‰

#### 4.3 æµ‹è¯•Engineç®¡ç†
1. æŸ¥çœ‹ä¸»å†…å®¹åŒºåŸŸ
2. åº”è¯¥æ˜¾ç¤ºEngineæœªè¿è¡ŒçŠ¶æ€
3. ç‚¹å‡»"å¯åŠ¨Engine"æŒ‰é’®
4. æ£€æŸ¥æ§åˆ¶å°è¾“å‡ºåŒºåŸŸ

#### 4.4 æµ‹è¯•æŠ¥å‘Šç”Ÿæˆ
1. ç‚¹å‡»"ç”ŸæˆæŠ¥å‘Š"æŒ‰é’®
2. è¾“å…¥æŸ¥è¯¢å†…å®¹
3. ç‚¹å‡»"ç”ŸæˆæŠ¥å‘Š"
4. æŸ¥çœ‹çŠ¶æ€æç¤º

### Step 5: æµ‹è¯•å‰åç«¯è¿æ¥

**å¦‚æœPythonåç«¯æœªè¿è¡Œ**:
- APIä¼šè¿”å› `Backend unreachable` é”™è¯¯
- è¿™æ˜¯æ­£å¸¸çš„ï¼Œè¯´æ˜Workers APIæ­£å¸¸å·¥ä½œ
- å‰ç«¯ä¼šæ˜¾ç¤ºç›¸åº”çš„é”™è¯¯æç¤º

**å¦‚æœPythonåç«¯è¿è¡Œ**:
- æµ‹è¯•å®Œæ•´çš„ç«¯åˆ°ç«¯æµç¨‹
- éªŒè¯æ‰€æœ‰åŠŸèƒ½

## ğŸ” æµ‹è¯•æ£€æŸ¥æ¸…å•

### Workers APIæµ‹è¯•
- [ ] å¥åº·æ£€æŸ¥è¿”å›200 OK
- [ ] ç³»ç»ŸçŠ¶æ€APIæ­£å¸¸ï¼ˆå³ä½¿åç«¯ä¸å¯ç”¨ï¼‰
- [ ] CORSé…ç½®æ­£ç¡®ï¼ˆå‰ç«¯å¯ä»¥è®¿é—®ï¼‰
- [ ] é”™è¯¯å¤„ç†æ­£å¸¸

### å‰ç«¯æµ‹è¯•
- [ ] é¡µé¢åŠ è½½æ­£å¸¸
- [ ] æœç´¢åŠŸèƒ½UIæ­£å¸¸
- [ ] é…ç½®å¯¹è¯æ¡†æ­£å¸¸æ‰“å¼€
- [ ] æŠ¥å‘Šå¯¹è¯æ¡†æ­£å¸¸æ‰“å¼€
- [ ] æ§åˆ¶å°è¾“å‡ºåŒºåŸŸæ­£å¸¸
- [ ] çŠ¶æ€è½®è¯¢æ­£å¸¸ï¼ˆæ£€æŸ¥Networkæ ‡ç­¾ï¼‰

### é›†æˆæµ‹è¯•
- [ ] å‰ç«¯å¯ä»¥è°ƒç”¨Workers API
- [ ] APIå“åº”æ­£ç¡®
- [ ] é”™è¯¯å¤„ç†UIæ­£å¸¸
- [ ] åŠ è½½çŠ¶æ€æ˜¾ç¤ºæ­£å¸¸

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜1: Workers APIæ— æ³•å¯åŠ¨

**ç—‡çŠ¶**: `npm run dev` å¤±è´¥

**æ’æŸ¥**:
```powershell
# 1. æ£€æŸ¥wrangleræ˜¯å¦å®‰è£…
wrangler --version

# 2. æ£€æŸ¥æ˜¯å¦ç™»å½•
wrangler whoami

# 3. æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
netstat -ano | findstr :8787

# 4. æŸ¥çœ‹è¯¦ç»†é”™è¯¯
cd bettafish-workers
npm run dev -- --verbose
```

**è§£å†³**:
- å®‰è£…wrangler: `npm install -g wrangler`
- ç™»å½•: `wrangler login`
- æ›´æ¢ç«¯å£ï¼ˆåœ¨wrangler.tomlä¸­ï¼‰

### é—®é¢˜2: å‰ç«¯æ— æ³•è¿æ¥API

**ç—‡çŠ¶**: CORSé”™è¯¯æˆ–è¿æ¥å¤±è´¥

**æ’æŸ¥**:
1. æ£€æŸ¥ `.env.local` ä¸­çš„ `NEXT_PUBLIC_API_URL`
2. ç¡®è®¤Workers APIæ­£åœ¨è¿è¡Œ
3. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°çš„é”™è¯¯ä¿¡æ¯

**è§£å†³**:
- ç¡®è®¤API URLæ­£ç¡®: `http://localhost:8787`
- æ£€æŸ¥ `wrangler.toml` ä¸­çš„CORSé…ç½®
- æ·»åŠ å‰ç«¯URLåˆ°CORSå…è®¸åˆ—è¡¨

### é—®é¢˜3: é¡µé¢æ˜¾ç¤ºé”™è¯¯

**ç—‡çŠ¶**: å‰ç«¯é¡µé¢æŠ¥é”™

**æ’æŸ¥**:
1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. æŸ¥çœ‹Consoleæ ‡ç­¾çš„é”™è¯¯
3. æŸ¥çœ‹Networkæ ‡ç­¾çš„è¯·æ±‚

**è§£å†³**:
- æ£€æŸ¥API URLé…ç½®
- ç¡®è®¤Workers APIè¿è¡Œ
- æ£€æŸ¥ä»£ç é”™è¯¯

### é—®é¢˜4: çŠ¶æ€è½®è¯¢ä¸å·¥ä½œ

**ç—‡çŠ¶**: çŠ¶æ€ä¸æ›´æ–°

**æ’æŸ¥**:
1. æ£€æŸ¥æµè§ˆå™¨Networkæ ‡ç­¾
2. æŸ¥çœ‹æ˜¯å¦æœ‰è½®è¯¢è¯·æ±‚
3. æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ

**è§£å†³**:
- æ£€æŸ¥APIç«¯ç‚¹æ˜¯å¦æ­£å¸¸
- æ£€æŸ¥è½®è¯¢é—´éš”è®¾ç½®
- æ£€æŸ¥é”™è¯¯å¤„ç†

## ğŸ“Š æµ‹è¯•ç»“æœè®°å½•

### APIæµ‹è¯•ç»“æœ

| ç«¯ç‚¹ | æ–¹æ³• | çŠ¶æ€ | å“åº”æ—¶é—´ | å¤‡æ³¨ |
|------|------|------|----------|------|
| /api/health | GET | âœ… | <100ms | æ­£å¸¸ |
| /api/status | GET | âœ… | <500ms | åç«¯ä¸å¯ç”¨æ—¶æ­£å¸¸ |
| /api/config | GET | âš ï¸ | - | éœ€è¦åç«¯ |
| /api/start/:app | POST | âš ï¸ | - | éœ€è¦åç«¯ |
| /api/search | POST | âš ï¸ | - | éœ€è¦åç«¯ |

### å‰ç«¯æµ‹è¯•ç»“æœ

| åŠŸèƒ½ | çŠ¶æ€ | å¤‡æ³¨ |
|------|------|------|
| é¡µé¢åŠ è½½ | âœ… | æ­£å¸¸ |
| æœç´¢UI | âœ… | æ­£å¸¸ |
| é…ç½®ç®¡ç† | âœ… | UIæ­£å¸¸ï¼Œéœ€è¦åç«¯ä¿å­˜ |
| æŠ¥å‘Šç”Ÿæˆ | âœ… | UIæ­£å¸¸ï¼Œéœ€è¦åç«¯å¤„ç† |
| çŠ¶æ€è½®è¯¢ | âœ… | æ­£å¸¸ |
| é”™è¯¯å¤„ç† | âœ… | æ­£å¸¸ |

## âœ… æµ‹è¯•å®Œæˆæ ‡å‡†

- [ ] Workers APIå¯åŠ¨æˆåŠŸ
- [ ] å‰ç«¯å¯åŠ¨æˆåŠŸ
- [ ] å¥åº·æ£€æŸ¥é€šè¿‡
- [ ] å‰ç«¯å¯ä»¥è®¿é—®API
- [ ] æ‰€æœ‰UIç»„ä»¶æ­£å¸¸
- [ ] é”™è¯¯å¤„ç†æ­£å¸¸
- [ ] æ— æ§åˆ¶å°é”™è¯¯

## ğŸ¯ ä¸‹ä¸€æ­¥

æµ‹è¯•é€šè¿‡åï¼š
1. é…ç½®Cloudflareèµ„æº
2. éƒ¨ç½²åˆ°å¼€å‘ç¯å¢ƒ
3. è¿›è¡Œç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

---

**æç¤º**: å¦‚æœé‡åˆ°é—®é¢˜ï¼ŒæŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°å’ŒWorkers APIç»ˆç«¯çš„é”™è¯¯ä¿¡æ¯ã€‚

