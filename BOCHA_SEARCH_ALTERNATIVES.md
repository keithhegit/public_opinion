# Bocha 多模态搜索替代方案

## Bocha 功能分析

Bocha 提供的核心功能：
1. **多模态搜索**：网页、图片、视频
2. **AI 总结**：自动生成搜索结果的 AI 摘要
3. **结构化数据（模态卡）**：天气、股票、汇率等结构化信息
4. **时效性搜索**：24小时内、一周内的信息
5. **追问建议**：基于搜索结果生成相关问题

**技术实现**：使用 REST API，返回 JSON 格式的结构化数据

---

## 替代方案（按推荐优先级）

### 🥇 方案 1：使用 Tavily API（推荐）

**优点**：
- ✅ 已经在 Query Engine 中使用，代码已存在
- ✅ 国际平台，稳定可靠
- ✅ 支持新闻搜索、图片搜索
- ✅ 支持时效性搜索（24小时、一周）
- ✅ 有免费额度

**缺点**：
- ❌ 不支持视频搜索
- ❌ 不支持结构化数据（模态卡）
- ❌ 需要修改代码适配

**申请地址**：https://www.tavily.com/

**功能对比**：
| 功能 | Bocha | Tavily |
|------|-------|--------|
| 网页搜索 | ✅ | ✅ |
| 图片搜索 | ✅ | ✅ |
| 视频搜索 | ✅ | ❌ |
| AI 总结 | ✅ | ✅ |
| 结构化数据 | ✅ | ❌ |
| 时效性搜索 | ✅ | ✅ |

**实施难度**：⭐⭐⭐（中等，需要修改代码适配）

---

### 🥈 方案 2：使用 Perplexity API

**优点**：
- ✅ 强大的 AI 搜索能力
- ✅ 自动生成高质量摘要
- ✅ 支持时效性搜索
- ✅ 对中文支持良好

**缺点**：
- ❌ 不支持图片/视频搜索
- ❌ 不支持结构化数据
- ❌ 需要修改代码适配
- ❌ 价格较高

**申请地址**：https://www.perplexity.ai/settings/api

**API 文档**：https://docs.perplexity.ai/

**成本**：
- Pro: $20/月（包含一定额度）
- 按量付费：较高

**实施难度**：⭐⭐⭐（中等，需要修改代码）

---

### 🥉 方案 3：使用 Serper API

**优点**：
- ✅ Google 搜索结果
- ✅ 支持图片搜索
- ✅ 价格便宜
- ✅ 响应快速

**缺点**：
- ❌ 不支持视频搜索
- ❌ 不支持 AI 总结（需要自己用 LLM 生成）
- ❌ 不支持结构化数据
- ❌ 需要修改代码适配

**申请地址**：https://serper.dev/

**成本**：
- 免费：2500 次/月
- 付费：$5/10,000 次

**实施难度**：⭐⭐⭐（中等，需要修改代码）

---

### 方案 4：使用 Exa AI

**优点**：
- ✅ 专注于高质量内容搜索
- ✅ 支持语义搜索
- ✅ 对中文支持良好

**缺点**：
- ❌ 不支持图片/视频搜索
- ❌ 不支持结构化数据
- ❌ 需要修改代码适配

**申请地址**：https://exa.ai/

**成本**：
- 免费：1000 次/月
- 付费：$10/10,000 次

**实施难度**：⭐⭐⭐（中等，需要修改代码）

---

### 方案 5：使用 You.com API

**优点**：
- ✅ 多模态搜索（网页、图片）
- ✅ AI 总结
- ✅ 对中文支持良好

**缺点**：
- ❌ 不支持视频搜索
- ❌ 不支持结构化数据
- ❌ 需要修改代码适配

**申请地址**：https://api.you.com/

**成本**：
- 免费：有限额度
- 付费：按量计费

**实施难度**：⭐⭐⭐（中等，需要修改代码）

---

### 方案 6：组合方案（Tavily + 其他服务）

**思路**：
- 使用 **Tavily** 进行网页和图片搜索
- 使用 **Gemini** 生成 AI 总结（你已经有了）
- 使用 **OpenWeatherMap** 等 API 获取结构化数据（天气、股票等）

**优点**：
- ✅ 功能完整
- ✅ 可以复用现有资源（Gemini）
- ✅ 灵活组合

**缺点**：
- ❌ 需要集成多个服务
- ❌ 代码复杂度较高

**实施难度**：⭐⭐⭐⭐（较高，需要较多代码修改）

---

## 功能对比表

| 方案 | 网页搜索 | 图片搜索 | 视频搜索 | AI总结 | 结构化数据 | 时效性 | 中文支持 | 成本 | 实施难度 |
|------|---------|---------|---------|--------|-----------|--------|---------|------|---------|
| **Bocha** | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | 中 | - |
| **Tavily** | ✅ | ✅ | ❌ | ✅ | ❌ | ✅ | ✅ | 低 | ⭐⭐⭐ |
| **Perplexity** | ✅ | ❌ | ❌ | ✅ | ❌ | ✅ | ✅ | 高 | ⭐⭐⭐ |
| **Serper** | ✅ | ✅ | ❌ | ❌* | ❌ | ✅ | ✅ | 低 | ⭐⭐⭐ |
| **Exa AI** | ✅ | ❌ | ❌ | ❌* | ❌ | ✅ | ✅ | 低 | ⭐⭐⭐ |
| **You.com** | ✅ | ✅ | ❌ | ✅ | ❌ | ✅ | ✅ | 中 | ⭐⭐⭐ |
| **组合方案** | ✅ | ✅ | ❌ | ✅ | ✅ | ✅ | ✅ | 低 | ⭐⭐⭐⭐ |

*需要自己用 LLM 生成

---

## 推荐方案

### 最佳选择：Tavily API（方案 1）

**理由**：
1. ✅ 已经在 Query Engine 中使用，代码已存在
2. ✅ 国际平台，稳定可靠
3. ✅ 价格便宜，有免费额度
4. ✅ 支持大部分核心功能（网页、图片、AI总结、时效性）
5. ✅ 对中文支持良好

**缺失功能**：
- 视频搜索：Media Engine 主要用于分析视频平台内容，视频搜索不是核心需求
- 结构化数据：可以通过其他 API 补充（如 OpenWeatherMap 获取天气）

**实施建议**：
1. 修改 `MediaEngine/tools/search.py`，将 `BochaMultimodalSearch` 替换为 `TavilyNewsAgency`
2. 适配返回数据格式（`BochaResponse` → `TavilyResponse`）
3. 使用 Gemini 生成 AI 总结（复用现有 LLM）

---

## 实施注意事项

### 1. 数据格式适配

Bocha 返回 `BochaResponse`，包含：
- `webpages`: 网页结果
- `images`: 图片结果
- `ai_summary`: AI 总结
- `modal_cards`: 结构化数据
- `suggested_questions`: 追问建议

Tavily 返回 `TavilyResponse`，包含：
- `results`: 网页结果
- `images`: 图片结果
- `answer`: AI 总结

需要适配这些字段。

### 2. 功能映射

| Bocha 功能 | Tavily 对应 |
|-----------|-----------|
| `comprehensive_search` | `deep_search_news` |
| `web_search_only` | `basic_search_news` |
| `search_last_24_hours` | `search_news_last_24_hours` |
| `search_last_week` | `search_news_last_week` |
| `search_for_structured_data` | 需要其他 API 补充 |

### 3. 结构化数据补充

如果需要结构化数据（天气、股票等），可以：
- 使用 **OpenWeatherMap API**（天气）
- 使用 **Alpha Vantage API**（股票）
- 使用 **ExchangeRate API**（汇率）

---

## 成本对比

| 方案 | 免费额度 | 付费价格 | 性价比 |
|------|---------|---------|--------|
| Bocha | 未知 | 未知 | - |
| Tavily | 1000 次/月 | $0.001/次 | ⭐⭐⭐⭐⭐ |
| Perplexity | 有限 | $20/月起 | ⭐⭐⭐ |
| Serper | 2500 次/月 | $5/10,000次 | ⭐⭐⭐⭐ |
| Exa AI | 1000 次/月 | $10/10,000次 | ⭐⭐⭐⭐ |
| You.com | 有限 | 按量计费 | ⭐⭐⭐ |

---

## 结论

**推荐使用 Tavily API**，因为：
1. 已经在项目中使用（Query Engine）
2. 功能覆盖大部分需求
3. 价格便宜
4. 实施难度适中

**如果必须保留视频搜索功能**，可以考虑：
- 保留 Bocha（如果价格可接受）
- 或使用组合方案（Tavily + YouTube API 等）

需要我帮你实施 Tavily 替代方案吗？

