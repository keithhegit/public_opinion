# ä¿®å¤ Workers è‡ªåŠ¨æ„å»ºé—®é¢˜

## ğŸ” é—®é¢˜è¯Šæ–­

Workers å·²ç»é…ç½®äº† Git é›†æˆï¼Œä½†æ¨é€ä»£ç åæ²¡æœ‰è‡ªåŠ¨æ„å»ºã€‚

## ğŸ“‹ æ£€æŸ¥æ­¥éª¤

### Step 1: æ£€æŸ¥ Git é›†æˆé…ç½®

æ ¹æ®æˆªå›¾ï¼ŒWorkers çš„ Git é›†æˆé…ç½®å¦‚ä¸‹ï¼š
- **Repository**: `keithhegit/public_opinion` âœ…
- **åˆ†æ”¯è·Ÿè¸ª**: `main` âœ…
- **æ ¹ç›®å½•**: `/` âš ï¸ï¼ˆå¯èƒ½éœ€è¦ä¿®æ”¹ï¼‰
- **æ„å»ºå‘½ä»¤**: `æ— ` âš ï¸ï¼ˆå¯èƒ½éœ€è¦è®¾ç½®ï¼‰
- **éƒ¨ç½²å‘½ä»¤**: `npx wrangler deploy` âœ…

### Step 2: æ£€æŸ¥æ ¹ç›®å½•è®¾ç½®

**é—®é¢˜**: æ ¹ç›®å½•è®¾ç½®ä¸º `/`ï¼Œä½† Workers ä»£ç åœ¨ `bettafish-workers/` ç›®å½•ä¸‹ã€‚

**è§£å†³æ–¹æ¡ˆ**:
1. åœ¨ Cloudflare Dashboard ä¸­ï¼Œè¿›å…¥ Workers è®¾ç½®
2. ç‚¹å‡» **æ„å»ºé…ç½®** æ—è¾¹çš„ç¼–è¾‘å›¾æ ‡
3. ä¿®æ”¹ **æ ¹ç›®å½• (Root Directory)** ä¸ºï¼š`bettafish-workers`
4. ç‚¹å‡» **Save**

### Step 3: æ£€æŸ¥æ„å»ºå‘½ä»¤

**å½“å‰çŠ¶æ€**: æ„å»ºå‘½ä»¤ä¸º `æ— `

**å»ºè®®é…ç½®**:
- **æ„å»ºå‘½ä»¤**: `npm install && npm run build`
- **éƒ¨ç½²å‘½ä»¤**: `npx wrangler deploy`
- **ç‰ˆæœ¬å‘½ä»¤**: `npx wrangler versions upload`ï¼ˆå¯é€‰ï¼‰

**æ³¨æ„**: å¦‚æœ Workers ä½¿ç”¨ TypeScriptï¼Œå¯èƒ½éœ€è¦æ„å»ºæ­¥éª¤ã€‚æ£€æŸ¥ `bettafish-workers/package.json` æ˜¯å¦æœ‰ `build` è„šæœ¬ã€‚

### Step 4: æ£€æŸ¥ package.json

åœ¨ `bettafish-workers/package.json` ä¸­åº”è¯¥æœ‰æ„å»ºè„šæœ¬ï¼š

```json
{
  "scripts": {
    "build": "tsc",  // æˆ– "wrangler deploy" æˆ–å…¶ä»–æ„å»ºå‘½ä»¤
    "deploy": "wrangler deploy"
  }
}
```

### Step 5: æ‰‹åŠ¨è§¦å‘æ„å»º

å¦‚æœè‡ªåŠ¨æ„å»ºä»ç„¶ä¸å·¥ä½œï¼Œå¯ä»¥ï¼š

1. **åœ¨ Cloudflare Dashboard ä¸­æ‰‹åŠ¨è§¦å‘**:
   - è¿›å…¥ Workers è¯¦æƒ…é¡µ
   - ç‚¹å‡» **Deployments** æ ‡ç­¾
   - ç‚¹å‡» **Create deployment** æˆ– **Redeploy**

2. **ä½¿ç”¨ Wrangler CLI**:
   ```bash
   cd bettafish-workers
   npm run deploy
   ```

## ğŸ”§ æ¨èçš„ Workers é…ç½®

### æ„å»ºé…ç½®

- **æ ¹ç›®å½•**: `bettafish-workers`
- **æ„å»ºå‘½ä»¤**: `npm install`ï¼ˆå¦‚æœä¸éœ€è¦æ„å»ºï¼Œå¯ä»¥ç•™ç©ºï¼‰
- **éƒ¨ç½²å‘½ä»¤**: `npx wrangler deploy`

### åˆ†æ”¯æ§åˆ¶

- **åˆ†æ”¯è·Ÿè¸ª**: `main` âœ…
- **æ‹‰å–è¯·æ±‚é¢„è§ˆ**: `å·²å¯ç”¨` âœ…

### æ„å»ºç›‘è§†è·¯å¾„

- **åŒ…æ‹¬è·¯å¾„**: `bettafish-workers/**` æˆ– `*`

## ğŸ“ éªŒè¯æ­¥éª¤

1. **ä¿®æ”¹é…ç½®å**:
   - ç­‰å¾…å‡ ç§’é’Ÿè®©é…ç½®ç”Ÿæ•ˆ
   - æˆ–è€…æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡éƒ¨ç½²

2. **æ¨é€æ–°ä»£ç **:
   ```bash
   git add .
   git commit -m "Test: Trigger Workers auto build"
   git push origin main
   ```

3. **æ£€æŸ¥éƒ¨ç½²**:
   - åœ¨ Cloudflare Dashboard ä¸­æŸ¥çœ‹ **Deployments** æ ‡ç­¾
   - åº”è¯¥çœ‹åˆ°æ–°çš„éƒ¨ç½²æ­£åœ¨æ„å»º
   - ç­‰å¾…æ„å»ºå®Œæˆï¼ˆé€šå¸¸ 1-2 åˆ†é’Ÿï¼‰

4. **æµ‹è¯• API**:
   ```bash
   curl https://bettafish-api-prod.keithhe2021.workers.dev/api/health
   ```

## ğŸš¨ å¸¸è§é—®é¢˜

### é—®é¢˜ 1: æ„å»ºå‘½ä»¤å¤±è´¥

**ç—‡çŠ¶**: éƒ¨ç½²çŠ¶æ€æ˜¾ç¤º "Failed"

**æ’æŸ¥**:
- æŸ¥çœ‹æ„å»ºæ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯
- æ£€æŸ¥ `package.json` ä¸­çš„è„šæœ¬æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ä¾èµ–æ˜¯å¦å®Œæ•´

### é—®é¢˜ 2: æ ¹ç›®å½•é”™è¯¯

**ç—‡çŠ¶**: æ„å»ºæ‰¾ä¸åˆ°æ–‡ä»¶

**è§£å†³**: ç¡®ä¿æ ¹ç›®å½•è®¾ç½®ä¸º `bettafish-workers`

### é—®é¢˜ 3: æƒé™é—®é¢˜

**ç—‡çŠ¶**: Git é›†æˆæ— æ³•è®¿é—®ä»“åº“

**è§£å†³**:
- æ£€æŸ¥ GitHub æƒé™
- é‡æ–°è¿æ¥ Git å­˜å‚¨åº“
- æ£€æŸ¥ API ä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆ

## âœ… å®Œæˆæ£€æŸ¥æ¸…å•

- [ ] æ ¹ç›®å½•å·²è®¾ç½®ä¸º `bettafish-workers`
- [ ] æ„å»ºå‘½ä»¤å·²é…ç½®ï¼ˆå¦‚æœéœ€è¦ï¼‰
- [ ] éƒ¨ç½²å‘½ä»¤ä¸º `npx wrangler deploy`
- [ ] åˆ†æ”¯è·Ÿè¸ªä¸º `main`
- [ ] æ¨é€ä»£ç åè‡ªåŠ¨è§¦å‘æ„å»º
- [ ] æ„å»ºæˆåŠŸå®Œæˆ
- [ ] API å¯ä»¥æ­£å¸¸è®¿é—®

